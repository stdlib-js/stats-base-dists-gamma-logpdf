{"version":3,"file":"index.mjs","sources":["../lib/regularised_gamma_prefix.js","../lib/gamma_p_derivative.js","../lib/logpdf.js","../lib/factory.js","../lib/index.js"],"sourcesContent":["/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*\n*\n* ## Notice\n*\n* The original C++ code and copyright notice are from the [Boost library]{@link http://www.boost.org/doc/libs/1_64_0/boost/math/special_functions/gamma.hpp}. The implementation has been modified for JavaScript.\n*\n* ```text\n* Copyright John Maddock 2006-7, 2013-14.\n* Copyright Paul A. Bristow 2007, 2013-14.\n* Copyright Nikhar Agrawal 2013-14.\n* Copyright Christopher Kormanyos 2013-14.\n*\n* Use, modification and distribution are subject to the\n* Boost Software License, Version 1.0. (See accompanying file\n* LICENSE or copy at http://www.boost.org/LICENSE_1_0.txt)\n* ```\n*/\n\n'use strict';\n\n// MODULES //\n\nvar lanczosSumExpGScaled = require( '@stdlib/math-base-special-gamma-lanczos-sum-expg-scaled' );\nvar gammaln = require( '@stdlib/math-base-special-gammaln' );\nvar gamma = require( '@stdlib/math-base-special-gamma' );\nvar log1p = require( '@stdlib/math-base-special-log1p' );\nvar sqrt = require( '@stdlib/math-base-special-sqrt' );\nvar abs = require( '@stdlib/math-base-special-abs' );\nvar exp = require( '@stdlib/math-base-special-exp' );\nvar pow = require( '@stdlib/math-base-special-pow' );\nvar max = require( '@stdlib/math-base-special-max' );\nvar min = require( '@stdlib/math-base-special-min' );\nvar ln = require( '@stdlib/math-base-special-ln' );\nvar MAX_LN = require( '@stdlib/constants-float64-max-ln' );\nvar MIN_LN = require( '@stdlib/constants-float64-min-ln' );\nvar G = require( '@stdlib/constants-float64-gamma-lanczos-g' );\nvar E = require( '@stdlib/constants-float64-e' );\n\n\n// MAIN //\n\n/**\n* Computes `(z^a)*(e^-z) / gamma(a)`.\n*\n* @private\n* @param {number} a - input value\n* @param {number} z - input value\n* @returns {number} function value\n*/\nfunction regularisedGammaPrefix( a, z ) {\n\tvar prefix;\n\tvar amza;\n\tvar agh;\n\tvar alz;\n\tvar amz;\n\tvar sq;\n\tvar d;\n\n\tagh = a + G - 0.5;\n\td = ( (z - a) - G + 0.5 ) / agh;\n\tif ( a < 1.0 ) {\n\t\t// Treat a < 1 as a special case because our Lanczos approximations are optimized against the factorials with a > 1, and for high precision types very small values of `a` can give rather erroneous results for gamma:\n\t\tif ( z <= MIN_LN ) {\n\t\t\t// Use logs, so should be free of cancellation errors:\n\t\t\treturn exp( ( a * ln(z) ) - z - gammaln( a ) );\n\t\t}\n\t\t// No danger of overflow as gamma(a) < 1/a for small a, so direct calculation:\n\t\treturn pow( z, a ) * exp( -z ) / gamma( a );\n\t}\n\tif ( abs(d*d*a) <= 100.0 && a > 150.0 ) {\n\t\t// Special case for large a and a ~ z:\n\t\tprefix = ( a * ( log1p( d ) - d ) ) + ( z * ( 0.5-G ) / agh );\n\t\tprefix = exp( prefix );\n\t}\n\telse {\n\t\t// General case. Direct computation is most accurate, but use various fallbacks for different parts of the problem domain:\n\t\talz = a * ln(z / agh);\n\t\tamz = a - z;\n\t\tif (\n\t\t\tmin(alz, amz) <= MIN_LN ||\n\t\t\tmax(alz, amz) >= MAX_LN\n\t\t) {\n\t\t\tamza = amz / a;\n\t\t\tif (\n\t\t\t\tmin(alz, amz)/2.0 > MIN_LN &&\n\t\t\t\tmax(alz, amz)/2.0 < MAX_LN\n\t\t\t) {\n\t\t\t\t// Compute square root of the result and then square it:\n\t\t\t\tsq = pow( z / agh, a / 2.0 ) * exp( amz / 2.0 );\n\t\t\t\tprefix = sq * sq;\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tmin(alz, amz)/4.0 > MIN_LN &&\n\t\t\t\tmax(alz, amz)/4.0 < MAX_LN &&\n\t\t\t\tz > a\n\t\t\t) {\n\t\t\t\t// Compute the 4th root of the result then square it twice:\n\t\t\t\tsq = pow( z / agh, a / 4.0 ) * exp( amz / 4.0 );\n\t\t\t\tprefix = sq * sq;\n\t\t\t\tprefix *= prefix;\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tamza > MIN_LN &&\n\t\t\t\tamza < MAX_LN\n\t\t\t) {\n\t\t\t\tprefix = pow( (z * exp(amza)) / agh, a );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tprefix = exp( alz + amz );\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tprefix = pow( z / agh, a ) * exp( amz );\n\t\t}\n\t}\n\tprefix *= sqrt( agh / E ) / lanczosSumExpGScaled( a );\n\treturn prefix;\n}\n\n\n// EXPORTS //\n\nmodule.exports = regularisedGammaPrefix;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*\n*\n* ## Notice\n*\n* The original C++ code and copyright notice are from the [Boost library]{@link http://www.boost.org/doc/libs/1_58_0/boost/math/special_functions/gamma.hpp}. The implementation has been modified for JavaScript.\n*\n* ```text\n* Copyright John Maddock 2006-7, 2013-14.\n* Copyright Paul A. Bristow 2007, 2013-14.\n* Copyright Nikhar Agrawal 2013-14.\n* Copyright Christopher Kormanyos 2013-14.\n*\n* Use, modification and distribution are subject to the\n* Boost Software License, Version 1.0. (See accompanying file\n* LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)\n* ```\n*/\n\n'use strict';\n\n// MODULES //\n\nvar gammaln = require( '@stdlib/math-base-special-gammaln' );\nvar exp = require( '@stdlib/math-base-special-exp' );\nvar ln = require( '@stdlib/math-base-special-ln' );\nvar PINF = require( '@stdlib/constants-float64-pinf' );\nvar FLOAT64_MAX = require( '@stdlib/constants-float64-max' );\nvar regularisedGammaPrefix = require( './regularised_gamma_prefix.js' );\n\n\n// MAIN //\n\n/**\n* Calculates the partial derivative with respect to x of the incomplete gamma function.\n*\n* @private\n* @param {PositiveNumber} a - function parameter\n* @param {NonNegativeNumber} x - function parameter\n* @returns {number} function value\n*/\nfunction gammaPDerivative( a, x ) {\n\tvar f1;\n\tif ( a <= 0.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( x < 0.0 ) {\n\t\treturn NaN;\n\t}\n\tif ( x === 0.0 ) {\n\t\tif ( a > 1.0 ) {\n\t\t\treturn 0.0;\n\t\t}\n\t\treturn ( a === 1.0 ) ? 1.0 : PINF;\n\t}\n\tf1 = regularisedGammaPrefix( a, x );\n\tif ( x < 1.0 && ( FLOAT64_MAX * x < f1 ) ) {\n\t\treturn PINF;\n\t}\n\tif ( f1 === 0.0 ) {\n\t\t// Underflow in calculation, use logs instead:\n\t\tf1 = (a * ln( x )) - x - gammaln( a ) - ln( x );\n\t\tf1 = exp( f1 );\n\t} else {\n\t\tf1 /= x;\n\t}\n\treturn f1;\n}\n\n\n// EXPORTS //\n\nmodule.exports = gammaPDerivative;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar isnan = require( '@stdlib/math-base-assert-is-nan' );\nvar ln = require( '@stdlib/math-base-special-ln' );\nvar PINF = require( '@stdlib/constants-float64-pinf' );\nvar NINF = require( '@stdlib/constants-float64-ninf' );\nvar gammaDeriv = require( './gamma_p_derivative.js' );\n\n\n// MAIN //\n\n/**\n* Evaluates the logarithm of the probability density function (PDF) for a gamma distribution with shape parameter `alpha` and rate parameter `beta` at a value `x`.\n*\n* @param {number} x - input value\n* @param {NonNegativeNumber} alpha - shape parameter\n* @param {PositiveNumber} beta - rate parameter\n* @returns {number} evaluated logPDF\n*\n* @example\n* var y = logpdf( 2.0, 0.5, 1.0 );\n* // returns ~-2.919\n*\n* @example\n* var y = logpdf( 0.1, 1.0, 1.0 );\n* // returns ~-0.1\n*\n* @example\n* var y = logpdf( -1.0, 4.0, 2.0 );\n* // returns -Infinity\n*\n* @example\n* var y = logpdf( NaN, 0.6, 1.0 );\n* // returns NaN\n*\n* @example\n* var y = logpdf( 0.0, NaN, 1.0 );\n* // returns NaN\n*\n* @example\n* var y = logpdf( 0.0, 1.0, NaN );\n* // returns NaN\n*\n* @example\n* // Negative shape parameter:\n* var y = logpdf( 2.0, -1.0, 1.0 );\n* // returns NaN\n*\n* @example\n* // Negative rate parameter:\n* var y = logpdf( 2.0, 1.0, -1.0 );\n* // returns NaN\n*/\nfunction logpdf( x, alpha, beta ) {\n\tif (\n\t\tisnan( x ) ||\n\t\tisnan( alpha ) ||\n\t\tisnan( beta ) ||\n\t\talpha < 0.0 ||\n\t\tbeta <= 0.0\n\t) {\n\t\treturn NaN;\n\t}\n\tif ( x < 0.0 || x === PINF ) {\n\t\treturn NINF;\n\t}\n\tif ( alpha === 0.0 ) {\n\t\t// Point mass at 0...\n\t\treturn ( x === 0.0 ) ? PINF : NINF;\n\t}\n\treturn ln( gammaDeriv( alpha, x * beta ) ) + ln( beta );\n}\n\n\n// EXPORTS //\n\nmodule.exports = logpdf;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nvar constantFunction = require( '@stdlib/utils-constant-function' );\nvar degenerate = require( '@stdlib/stats-base-dists-degenerate-logpdf' ).factory;\nvar isnan = require( '@stdlib/math-base-assert-is-nan' );\nvar ln = require( '@stdlib/math-base-special-ln' );\nvar NINF = require( '@stdlib/constants-float64-ninf' );\nvar PINF = require( '@stdlib/constants-float64-pinf' );\nvar gammaDeriv = require( './gamma_p_derivative.js' );\n\n\n// MAIN //\n\n/**\n* Returns a function for evaluating the logarithm of the probability density function (PDF) for a gamma distribution with shape parameter `alpha` and rate parameter `beta`.\n*\n* @param {NonNegativeNumber} alpha - shape parameter\n* @param {PositiveNumber} beta - rate parameter\n* @returns {Function} logPDF\n*\n* @example\n* var logpdf = factory( 3.0, 1.5 );\n*\n* var y = logpdf( 1.0 );\n* // returns ~-0.977\n*\n* y = logpdf( 4.0 );\n* // returns ~-2.704\n*/\nfunction factory( alpha, beta ) {\n\tif (\n\t\tisnan( alpha ) ||\n\t\tisnan( beta ) ||\n\t\talpha < 0.0 ||\n\t\tbeta <= 0.0\n\t) {\n\t\treturn constantFunction( NaN );\n\t}\n\tif ( alpha === 0.0 ) {\n\t\treturn degenerate( 0.0 );\n\t}\n\treturn logpdf;\n\n\t/**\n\t* Evaluates the logarithm of the probability density function (PDF) for a gamma distribution.\n\t*\n\t* @private\n\t* @param {number} x - input value\n\t* @returns {number} evaluated logPDF\n\t*\n\t* @example\n\t* var y = logpdf( -1.2 );\n\t* // returns <number>\n\t*/\n\tfunction logpdf( x ) {\n\t\tif ( isnan( x ) ) {\n\t\t\treturn NaN;\n\t\t}\n\t\tif ( x < 0.0 || x === PINF ) {\n\t\t\treturn NINF;\n\t\t}\n\t\treturn ln( gammaDeriv( alpha, x * beta ) ) + ln( beta );\n\t}\n}\n\n\n// EXPORTS //\n\nmodule.exports = factory;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n/**\n* Gamma distribution logarithm of probability density function (PDF).\n*\n* @module @stdlib/stats-base-dists-gamma-logpdf\n*\n* @example\n* var logpdf = require( '@stdlib/stats-base-dists-gamma-logpdf' );\n*\n* var y = logpdf( 2.0, 0.5, 1.0 );\n* // returns ~-2.919\n*\n* @example\n* var factory = require( '@stdlib/stats-base-dists-gamma-logpdf' ).factory;\n*\n* var logpdf = factory( 6.0, 7.0 );\n* var y = logpdf( 2.0 );\n* // returns ~-3.646\n*/\n\n// MODULES //\n\nvar setReadOnly = require( '@stdlib/utils-define-nonenumerable-read-only-property' );\nvar logpdf = require( './logpdf.js' );\nvar factory = require( './factory.js' );\n\n\n// MAIN //\n\nsetReadOnly( logpdf, 'factory', factory );\n\n\n// EXPORTS //\n\nmodule.exports = logpdf;\n"],"names":["lanczosSumExpGScaled","require$$0","gammaln","require$$1","gamma","require$$2","log1p","require$$3","sqrt","require$$4","abs","require$$5","exp","require$$6","pow","require$$7","max","require$$8","min","require$$9","ln","require$$10","MAX_LN","require$$11","MIN_LN","require$$12","G","require$$13","E","require$$14","PINF","FLOAT64_MAX","regularisedGammaPrefix","a","z","prefix","amza","agh","alz","amz","sq","d","gamma_p_derivative","x","f1","NaN","isnan","NINF","gammaDeriv","logpdf_1","alpha","beta","constantFunction","degenerate","factory","logpdf","lib"],"mappings":"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"}